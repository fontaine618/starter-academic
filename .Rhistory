mean = 2.0
variance = 0.8
sigmoid = function(x) 1. / (1. + exp(-x))
log_sigmoid = function(x) log(sigmoid(x))
lambda = function(t) (sigmoid(t) - 0.5) / t
quad_bound = function(x, t){
log_sigmoid(t) + (x - t) / 2. - lambda(t) * (x^2 - t^2) / 2.
}
xs = seq(-10, 10, length.out = 1000)
true = log_sigmoid(xs)
#true = log_sigmoid(-xs)
t = mean^2 + variance
bound1 = quad_bound(xs, t)
bound2 = quad_bound(xs, -t)
d = dnorm(xs, mean, sqrt(variance))
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true), type="l", col = 1)
points(xs, exp(bound1), type="l", col = 2)
points(xs, exp(bound2), type="l", col = 3)
points(xs, d, type="l", col = 1, lty=3)
t
log_sigmoid(t)
xs = seq(-10, 10, length.out = 1000)
true = log_sigmoid(xs)
true = log_sigmoid(-xs)
t = mean^2 + variance
bound1 = quad_bound(xs, t)
bound2 = quad_bound(xs, -t)
d = dnorm(xs, mean, sqrt(variance))
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true), type="l", col = 1)
points(xs, exp(bound1), type="l", col = 2)
points(xs, exp(bound2), type="l", col = 3)
points(xs, d, type="l", col = 1, lty=3)
true = log_sigmoid(-xs)
t = -(mean^2 + variance)
bound1 = quad_bound(xs, t)
bound2 = quad_bound(xs, -t)
d = dnorm(xs, -mean, sqrt(variance))
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true), type="l", col = 1)
points(xs, exp(bound1), type="l", col = 2)
points(xs, exp(bound2), type="l", col = 3)
points(xs, d, type="l", col = 1, lty=3)
true = log_sigmoid(-xs)
t = -(mean^2 + variance)
bound1 = quad_bound(xs, t)
d = dnorm(xs, -mean, sqrt(variance))
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true), type="l", col = 1)
points(xs, exp(bound1), type="l", col = 2)
points(xs, d, type="l", col = 1, lty=3)
true = log_sigmoid(xs)
t = mean^2 + variance
bound1 = quad_bound(xs, t)
d = dnorm(xs, mean, sqrt(variance))
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true), type="l", col = 1)
points(xs, exp(bound1), type="l", col = 2)
points(xs, d, type="l", col = 1, lty=3)
mean = 0.2
variance = 0.8
sigmoid = function(x) 1. / (1. + exp(-x))
log_sigmoid = function(x) log(sigmoid(x))
lambda = function(t) (sigmoid(t) - 0.5) / t
quad_bound = function(x, t){
log_sigmoid(t) + (x - t) / 2. - lambda(t) * (x^2 - t^2) / 2.
}
true = log_sigmoid(xs)
t = mean^2 + variance
bound1 = quad_bound(xs, t)
d = dnorm(xs, mean, sqrt(variance))
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true), type="l", col = 1)
points(xs, exp(bound1), type="l", col = 2)
points(xs, d, type="l", col = 1, lty=3)
mean = 1.0
variance = 0.8
sigmoid = function(x) 1. / (1. + exp(-x))
log_sigmoid = function(x) log(sigmoid(x))
lambda = function(t) (sigmoid(t) - 0.5) / t
quad_bound = function(x, t){
log_sigmoid(t) + (x - t) / 2. - lambda(t) * (x^2 - t^2) / 2.
}
xs = seq(-10, 10, length.out = 1000)
true = log_sigmoid(xs)
t = mean^2 + variance
bound1 = quad_bound(xs, t)
d = dnorm(xs, mean, sqrt(variance))
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true), type="l", col = 1)
points(xs, exp(bound1), type="l", col = 2)
points(xs, d, type="l", col = 1, lty=3)
true = log_sigmoid(-xs)
t = -(mean^2 + variance)
bound1 = quad_bound(xs, t)
d = dnorm(xs, -mean, sqrt(variance))
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true), type="l", col = 1)
points(xs, exp(bound1), type="l", col = 2)
points(xs, d, type="l", col = 1, lty=3)
true = log_sigmoid(-xs)
t = -(mean^2 + variance)
bound1 = quad_bound(-xs, t)
d = dnorm(xs, -mean, sqrt(variance))
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true), type="l", col = 1)
points(xs, exp(bound1), type="l", col = 2)
points(xs, d, type="l", col = 1, lty=3)
print(c(true=sum(d*true), approx=mean(d*bound1)))
true = log_sigmoid(-xs)
t = -(mean^2 + variance)
bound1 = quad_bound(-xs, t)
d = dnorm(xs, -mean, sqrt(variance))
print(c(true=sum(d*true), approx=mean(d*bound1)))
d
true
print(c(true=sum(d*true), approx=sum(d*bound1)))
true = log_sigmoid(-xs)
t = -(mean^2 + variance)
bound1 = quad_bound(-xs, t)
d = dnorm(xs, -mean, sqrt(variance))
print(c(true=sum(d*true), approx=sum(d*bound1)))
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true), type="l", col = 1)
points(xs, exp(bound1), type="l", col = 2)
points(xs, d, type="l", col = 1, lty=3)
xs = seq(-10, 10, length.out = 1000)
mean = 2.0
variance = 0.8
true = log_sigmoid(xs)
t = mean^2 + variance
bound1 = quad_bound(xs, t)
d = dnorm(xs, mean, sqrt(variance))
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true), type="l", col = 1)
points(xs, exp(bound1), type="l", col = 2)
points(xs, d, type="l", col = 1, lty=3)
true = log_sigmoid(-xs)
t = -(mean^2 + variance)
bound1 = quad_bound(-xs, t)
d = dnorm(xs, -mean, sqrt(variance))
print(c(true=sum(d*true), approx=sum(d*bound1)))
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true), type="l", col = 1)
points(xs, exp(bound1), type="l", col = 2)
points(xs, d, type="l", col = 1, lty=3)
t = -(mean^2 + variance)/2
bound1 = quad_bound(-xs, t)
d = dnorm(xs, -mean, sqrt(variance))
print(c(true=sum(d*true), approx=sum(d*bound1)))
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true), type="l", col = 1)
points(xs, exp(bound1), type="l", col = 2)
points(xs, d, type="l", col = 1, lty=3)
t = (mean^2 + variance)/2
bound1 = quad_bound(-xs, t)
d = dnorm(xs, -mean, sqrt(variance))
print(c(true=sum(d*true), approx=sum(d*bound1)))
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true), type="l", col = 1)
points(xs, exp(bound1), type="l", col = 2)
points(xs, d, type="l", col = 1, lty=3)
t
sapply(seq(0, 5, length.out = 101), function(t){
bound = quad_bound(-xs, t)
approx = sum(d*bound)
c(t, approx)
})
t(sapply(seq(0, 5, length.out = 101), function(t){
bound = quad_bound(-xs, t)
approx = sum(d*bound)
c(t, approx)
}))
(mean^2 + variance)
print(c(true=sum(d*true), approx=sum(d*bound1)))
true = log_sigmoid(-xs)
t = sqrt(mean^2 + variance)
bound1 = quad_bound(-xs, t)
d = dnorm(xs, -mean, sqrt(variance))
print(c(true=sum(d*true), approx=sum(d*bound1)))
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true), type="l", col = 1)
points(xs, exp(bound1), type="l", col = 2)
points(xs, d, type="l", col = 1, lty=3)
log_likelihood = function(x, A) A * log_sigmoid(x) + (1 - A) * log_sigmoid(-x)
lower_bound = function(x, A, t) log_sigmoid(t) + (A - 0.5) * x - t/2
xs = seq(-10, 10, length.out = 1000)
mean = 2.0
variance = 0.8
t = sqrt(mean^2 + variance)
d = dnorm(xs, mean, sqrt(variance))
true_llk = log_likelihood(xs, 1)
approx_llk = lower_bound(xs, 1, t)
sigmoid = function(x) 1. / (1. + exp(-x))
log_sigmoid = function(x) log(sigmoid(x))
lambda = function(t) (sigmoid(t) - 0.5) / t
quad_bound = function(x, t){
log_sigmoid(t) + (x - t) / 2. - lambda(t) * (x^2 - t^2) / 2.
}
log_likelihood = function(x, A) A * log_sigmoid(x) + (1 - A) * log_sigmoid(-x)
lower_bound = function(x, A, t) log_sigmoid(t) + (A - 0.5) * x - t/2
xs = seq(-10, 10, length.out = 1000)
mean = 2.0
variance = 0.8
t = sqrt(mean^2 + variance)
d = dnorm(xs, mean, sqrt(variance))
true_llk = log_likelihood(xs, 1)
approx_llk = lower_bound(xs, 1, t)
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true_llk), type="l", col = 1)
points(xs, exp(approx_llk), type="l", col = 2)
points(xs, d, type="l", col = 1, lty=3)
# sum
log_likelihood = function(x, A) A * log_sigmoid(x) + (1 - A) * log_sigmoid(-x)
lower_bound = function(x, A, t) log_sigmoid(t) + (A - 0.5) * x + t/2
xs = seq(-10, 10, length.out = 1000)
mean = 2.0
variance = 0.8
t = sqrt(mean^2 + variance)
d = dnorm(xs, mean, sqrt(variance))
true_llk = log_likelihood(xs, 1)
approx_llk = lower_bound(xs, 1, t)
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true_llk), type="l", col = 1)
points(xs, exp(approx_llk), type="l", col = 2)
points(xs, d, type="l", col = 1, lty=3)
# sum
log_likelihood = function(x, A) A * log_sigmoid(x) + (1 - A) * log_sigmoid(-x)
lower_bound = function(x, A, t) log_sigmoid(t) + (A - 0.5) * x
xs = seq(-10, 10, length.out = 1000)
mean = 2.0
variance = 0.8
t = sqrt(mean^2 + variance)
d = dnorm(xs, mean, sqrt(variance))
true_llk = log_likelihood(xs, 1)
approx_llk = lower_bound(xs, 1, t)
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true_llk), type="l", col = 1)
points(xs, exp(approx_llk), type="l", col = 2)
points(xs, d, type="l", col = 1, lty=3)
# sum
log_likelihood = function(x, A) A * log_sigmoid(x) + (1 - A) * log_sigmoid(-x)
lower_bound = function(x, A, t) log_sigmoid(t) + (A - 0.5) * x - t / 2
xs = seq(-10, 10, length.out = 1000)
mean = 2.0
variance = 0.8
t = sqrt(mean^2 + variance)
d = dnorm(xs, mean, sqrt(variance))
true_llk = log_likelihood(xs, 1)
approx_llk = lower_bound(xs, 1, t)
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true_llk), type="l", col = 1)
points(xs, exp(approx_llk), type="l", col = 2)
points(xs, d, type="l", col = 1, lty=3)
# sum
log_likelihood = function(x, A) A * log_sigmoid(x) + (1 - A) * log_sigmoid(-x)
lower_bound = function(x, A, t) log_sigmoid(t) + (A - 0.5) * x - t / 2
lower_bound = function(x, A, t) {
A * (log_sigmoid(t) + (x - t) / 2 - lambda(t) * (x^2 - t^2) / 2)
+ (1 - A) * (log_sigmoid(t) + (-x - t) / 2 - lambda(t) * (x^2 - t^2) / 2)
}
xs = seq(-10, 10, length.out = 1000)
mean = 2.0
variance = 0.8
t = sqrt(mean^2 + variance)
d = dnorm(xs, mean, sqrt(variance))
true_llk = log_likelihood(xs, 1)
approx_llk = lower_bound(xs, 1, t)
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true_llk), type="l", col = 1)
points(xs, exp(approx_llk), type="l", col = 2)
points(xs, d, type="l", col = 1, lty=3)
lower_bound = function(x, A, t) A * quad_bound(x, t) + (1 - A) * quad_bound(-x, t)
xs = seq(-10, 10, length.out = 1000)
mean = 2.0
variance = 0.8
t = sqrt(mean^2 + variance)
d = dnorm(xs, mean, sqrt(variance))
true_llk = log_likelihood(xs, 1)
approx_llk = lower_bound(xs, 1, t)
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true_llk), type="l", col = 1)
points(xs, exp(approx_llk), type="l", col = 2)
points(xs, d, type="l", col = 1, lty=3)
lower_bound = function(x, A, t) log_sigmoid(t) + (A - 0.5) * x - t / 2
xs = seq(-10, 10, length.out = 1000)
mean = 2.0
variance = 0.8
t = sqrt(mean^2 + variance)
d = dnorm(xs, mean, sqrt(variance))
true_llk = log_likelihood(xs, 1)
approx_llk = lower_bound(xs, 1, t)
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true_llk), type="l", col = 1)
points(xs, exp(approx_llk), type="l", col = 2)
points(xs, d, type="l", col = 1, lty=3)
xs = seq(-10, 10, length.out = 1000)
mean = 2.0
variance = 0.8
t = sqrt(mean^2 + variance)
d = dnorm(xs, mean, sqrt(variance))
true_llk = log_likelihood(xs, 1)
approx_llk = lower_bound(xs, 1, t)
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true_llk), type="l", col = 1)
points(xs, exp(approx_llk), type="l", col = 2)
points(xs, d, type="l", col = 1, lty=3)
lower_bound = function(x, A, t) A * quad_bound(x, t) + (1 - A) * quad_bound(-x, t)
xs = seq(-10, 10, length.out = 1000)
mean = 2.0
variance = 0.8
t = sqrt(mean^2 + variance)
d = dnorm(xs, mean, sqrt(variance))
true_llk = log_likelihood(xs, 1)
approx_llk = lower_bound(xs, 1, t)
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true_llk), type="l", col = 1)
points(xs, exp(approx_llk), type="l", col = 2)
points(xs, d, type="l", col = 1, lty=3)
log_likelihood = function(x, A) A * log_sigmoid(x) + (1 - A) * log_sigmoid(-x)
lower_bound2 = function(x, A, t) log_sigmoid(t) + (A - 0.5) * x - t / 2
lower_bound = function(x, A, t) A * quad_bound(x, t) + (1 - A) * quad_bound(-x, t)
xs = seq(-10, 10, length.out = 1000)
mean = 2.0
variance = 0.8
t = sqrt(mean^2 + variance)
d = dnorm(xs, mean, sqrt(variance))
true_llk = log_likelihood(xs, 1)
approx_llk = lower_bound(xs, 1, t)
approx_llk2 = lower_bound2(xs, 1, t)
plot(NA, xlim = range(xs), ylim = 0:1)
points(xs, exp(true_llk), type="l", col = 1)
points(xs, exp(approx_llk), type="l", col = 2)
points(xs, d, type="l", col = 1, lty=3)
print(c(true=sum(d*true), approx=sum(d*approx_llk), approx2=sum(d*approx_llk2)))
print(c(true=sum(d*true_llk), approx=sum(d*approx_llk), approx2=sum(d*approx_llk2)))
